{"ast":null,"code":"import { FETCH_BOOKS_FAILURE, FETCH_BOOKS_REQUEST, FETCH_BOOKS_FINALLY, FETCH_BOOKS_SUCCESS, BOOK_ADDED_TO_CART, BOOK_REMOVED_FROM_CART, BOOK_DELETED_FROM_CART } from \"./types\";\nconst initialState = {\n  books: [],\n  loading: true,\n  error: false,\n  cartItems: [],\n  orderTotal: 0\n};\n\nconst updateCartItems = (cartItems, idx, item) => {\n  if (item.count === 0) {\n    return [...cartItems.filter(el => el.id !== item.id)];\n  }\n\n  if (idx === -1) {\n    return [...cartItems, item];\n  }\n\n  return [...cartItems.slice(0, idx), item, ...cartItems.slice(idx + 1)];\n};\n\nconst createCartItem = function (book) {\n  let item = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  let quantity = arguments.length > 2 ? arguments[2] : undefined;\n  const {\n    id = book.id,\n    count = 0,\n    name = book.title,\n    total = 0\n  } = item;\n  return {\n    id,\n    name,\n    count: count + quantity,\n    total: total + quantity * book.price\n  };\n};\n\nconst updateOrder = (state, bookId, quantity) => {\n  const {\n    cartItems,\n    books,\n    orderTotal\n  } = state;\n  const book = books.find(_ref => {\n    let {\n      id\n    } = _ref;\n    return id === bookId;\n  });\n  const itemIndex = cartItems.findIndex(_ref2 => {\n    let {\n      id\n    } = _ref2;\n    return id === bookId;\n  });\n  const cartBook = cartItems[itemIndex];\n  const newItem = createCartItem(book, cartBook, quantity);\n  const element = orderTotal;\n\n  for (let index = 0; index < cartItems.length; index++) {\n    const element = cartItems.book[index] * createCartItem.item;\n    console.log(element);\n  } // v cartItemse est vse books my mojem ymnojit vse books na total cherez zikl\n\n\n  return { ...state,\n    cartItems: updateCartItems(cartItems, itemIndex, newItem),\n    element\n  };\n};\n\nconst reducer = function () {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    case FETCH_BOOKS_SUCCESS:\n      return { ...state,\n        error: false,\n        books: action.payload\n      };\n\n    case FETCH_BOOKS_FAILURE:\n      return { ...state,\n        error: action.payload\n      };\n\n    case FETCH_BOOKS_FINALLY:\n      return { ...state,\n        loading: false\n      };\n\n    case FETCH_BOOKS_REQUEST:\n      return { ...state,\n        loading: true,\n        error: false\n      };\n\n    case BOOK_ADDED_TO_CART:\n      return updateOrder(state, action.payload, 1);\n\n    case BOOK_REMOVED_FROM_CART:\n      return updateOrder(state, action.payload, -1);\n\n    case BOOK_DELETED_FROM_CART:\n      const item = state.cartItems.find(_ref3 => {\n        let {\n          id\n        } = _ref3;\n        return id === action.payload;\n      });\n      return updateOrder(state, action.payload, -item.count);\n\n    default:\n      return state;\n  }\n};\n\nexport default reducer;","map":{"version":3,"names":["FETCH_BOOKS_FAILURE","FETCH_BOOKS_REQUEST","FETCH_BOOKS_FINALLY","FETCH_BOOKS_SUCCESS","BOOK_ADDED_TO_CART","BOOK_REMOVED_FROM_CART","BOOK_DELETED_FROM_CART","initialState","books","loading","error","cartItems","orderTotal","updateCartItems","idx","item","count","filter","el","id","slice","createCartItem","book","quantity","name","title","total","price","updateOrder","state","bookId","find","itemIndex","findIndex","cartBook","newItem","element","index","length","console","log","reducer","action","type","payload"],"sources":["C:/Users/user/Desktop/front end/homework/REACT/f/src/redux/reducers.js"],"sourcesContent":["import { FETCH_BOOKS_FAILURE, FETCH_BOOKS_REQUEST, FETCH_BOOKS_FINALLY, FETCH_BOOKS_SUCCESS, BOOK_ADDED_TO_CART, BOOK_REMOVED_FROM_CART, BOOK_DELETED_FROM_CART } from \"./types\";\n\nconst initialState = {\n    books: [],\n    loading: true,\n    error: false,\n    cartItems: [],\n    orderTotal: 0,\n};\n\n\n\nconst updateCartItems = (cartItems, idx, item) => {\n    if (item.count === 0) {\n        return [...cartItems.filter((el) => el.id !== item.id)]\n    }\n    if (idx === -1) {\n        return [...cartItems, item];\n    }\n\n    return [...cartItems.slice(0, idx), item, ...cartItems.slice(idx + 1)];\n};\n\nconst createCartItem = (book, item = {}, quantity) => {\n    const {id=book.id, count = 0, name = book.title, total = 0} = item;\n\n    return {\n        id, \n        name,\n        count: count + quantity,\n        total: total + quantity * book.price,\n    };\n};\n\nconst updateOrder = (state, bookId, quantity) => {\n    const {cartItems, books, orderTotal} = state;\n   \n    const book = books.find(({id}) => id===bookId);\n    const itemIndex = cartItems.findIndex(({id}) => id === bookId);\n    const cartBook = cartItems[itemIndex];\n\n    const newItem = createCartItem(book, cartBook, quantity);\n    const element = orderTotal;\n\n    for (let index = 0; index < cartItems.length; index++) {\n        const element = cartItems.book[index] * createCartItem.item;\n        console.log(element);\n    }\n\n    // v cartItemse est vse books my mojem ymnojit vse books na total cherez zikl\n\n    return {\n        ...state,\n        cartItems: updateCartItems(cartItems, itemIndex, newItem),\n        element\n    };\n}\n\nconst reducer = (state = initialState, action) => {\n    switch (action.type) {\n        case FETCH_BOOKS_SUCCESS:\n            return {\n                ...state,\n                error: false,\n                books: action.payload,\n            };\n        case FETCH_BOOKS_FAILURE:\n            return{\n                ...state,\n                error: action.payload,\n            }\n        case FETCH_BOOKS_FINALLY:\n            return{\n                ...state,\n                loading: false\n            }\n        case FETCH_BOOKS_REQUEST:\n            return{\n                ...state,\n                loading: true,\n                error: false,\n            }\n        case BOOK_ADDED_TO_CART:\n            return updateOrder(state, action.payload, 1)\n\n        case BOOK_REMOVED_FROM_CART: \n            return updateOrder(state, action.payload, -1)\n        \n        case BOOK_DELETED_FROM_CART:\n            const item = state.cartItems.find(({id}) => id === action.payload);\n            return updateOrder(state, action.payload, -item.count)\n        default: \n            return state;\n    }\n}\n\nexport default reducer;"],"mappings":"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"},"metadata":{},"sourceType":"module"}